import{d as W,p as O,l as V,z as j,c as g,a as t,b as l,i as k,w as a,e as u,r as v,F as N,n as b,t as y,q as D,E as C,o as d}from"./index-DoZDeQgx.js";const E={class:"max-w-5xl mx-auto"},z={class:"mb-4 flex gap-2"},F={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Y={class:"flex justify-between items-center"},B={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded text-sm overflow-auto"},H={class:"flex justify-between items-center"},G={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded text-sm overflow-auto max-h-64"},K={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},R={key:0,class:"p-3 bg-gray-50 dark:bg-gray-700 rounded"},P={class:"font-mono"},Q={key:1,class:"p-3 bg-gray-50 dark:bg-gray-700 rounded"},U={key:2,class:"p-3 bg-gray-50 dark:bg-gray-700 rounded"},$={class:"font-mono"},h={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded font-mono text-sm break-all"},L=W({__name:"JwtDecoder",setup(q){const m=O(""),s=V(()=>{if(!m.value.trim())return null;try{const o=m.value.split(".");if(o.length!==3)return{error:"Invalid JWT format. JWT should have 3 parts separated by dots."};const e=f=>{const n=f.replace(/-/g,"+").replace(/_/g,"/"),x=n+"=".repeat((4-n.length%4)%4);return JSON.parse(atob(x))},p=e(o[0]),i=e(o[1]),r=f=>f?j(f*1e3).format("YYYY-MM-DD HH:mm:ss"):null,c=i.exp?i.exp*1e3<Date.now():!1;return{header:p,payload:i,signature:o[2],formattedTimes:{iat:r(i.iat),exp:r(i.exp),nbf:r(i.nbf)},isExpired:c}}catch(o){return{error:"Failed to decode JWT: "+o.message}}}),_=async o=>{try{await navigator.clipboard.writeText(o),C.success("已复制")}catch{C.error("复制失败")}},M=()=>{m.value=""},S=()=>{m.value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"};return(o,e)=>{const p=v("el-button"),i=v("el-input"),r=v("el-card"),c=v("el-alert"),f=v("el-empty");return d(),g("div",E,[e[16]||(e[16]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},"JWT 解析"),t("p",{class:"text-gray-500"},"解析并查看 JWT Token 内容")],-1)),t("div",z,[l(p,{onClick:M},{default:a(()=>[...e[3]||(e[3]=[u("清空",-1)])]),_:1}),l(p,{onClick:S,text:""},{default:a(()=>[...e[4]||(e[4]=[u("加载示例",-1)])]),_:1})]),l(r,{class:"mb-4"},{header:a(()=>[...e[5]||(e[5]=[u("输入 JWT",-1)])]),default:a(()=>[l(i,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=n=>m.value=n),type:"textarea",rows:4,placeholder:"请输入 JWT Token...",class:"font-mono"},null,8,["modelValue"])]),_:1}),s.value?(d(),g(N,{key:0},[s.value.error?(d(),k(c,{key:0,type:"error",title:s.value.error,closable:!1,class:"mb-4"},null,8,["title"])):(d(),g(N,{key:1},[s.value.isExpired?(d(),k(c,{key:0,type:"warning",title:"此 Token 已过期",closable:!1,class:"mb-4"})):b("",!0),t("div",F,[l(r,null,{header:a(()=>[t("div",Y,[e[7]||(e[7]=t("span",{class:"text-red-500"},"Header",-1)),l(p,{size:"small",onClick:e[1]||(e[1]=n=>_(JSON.stringify(s.value.header,null,2)))},{default:a(()=>[...e[6]||(e[6]=[u("复制",-1)])]),_:1})])]),default:a(()=>[t("pre",B,y(JSON.stringify(s.value.header,null,2)),1)]),_:1}),l(r,null,{header:a(()=>[t("div",H,[e[9]||(e[9]=t("span",{class:"text-purple-500"},"Payload",-1)),l(p,{size:"small",onClick:e[2]||(e[2]=n=>_(JSON.stringify(s.value.payload,null,2)))},{default:a(()=>[...e[8]||(e[8]=[u("复制",-1)])]),_:1})])]),default:a(()=>[t("pre",G,y(JSON.stringify(s.value.payload,null,2)),1)]),_:1})]),l(r,{class:"mt-4"},{header:a(()=>[...e[10]||(e[10]=[u("时间信息",-1)])]),default:a(()=>{var n,x,T,J,w,I;return[t("div",K,[(n=s.value.formattedTimes)!=null&&n.iat?(d(),g("div",R,[e[11]||(e[11]=t("div",{class:"text-sm text-gray-500"},"签发时间 (iat)",-1)),t("div",P,y((x=s.value.formattedTimes)==null?void 0:x.iat),1)])):b("",!0),(T=s.value.formattedTimes)!=null&&T.exp?(d(),g("div",Q,[e[12]||(e[12]=t("div",{class:"text-sm text-gray-500"},"过期时间 (exp)",-1)),t("div",{class:D(["font-mono",s.value.isExpired?"text-red-500":""])},y((J=s.value.formattedTimes)==null?void 0:J.exp),3)])):b("",!0),(w=s.value.formattedTimes)!=null&&w.nbf?(d(),g("div",U,[e[13]||(e[13]=t("div",{class:"text-sm text-gray-500"},"生效时间 (nbf)",-1)),t("div",$,y((I=s.value.formattedTimes)==null?void 0:I.nbf),1)])):b("",!0)])]}),_:1}),l(r,{class:"mt-4"},{header:a(()=>[...e[14]||(e[14]=[t("span",{class:"text-blue-500"},"Signature",-1)])]),default:a(()=>[t("div",h,y(s.value.signature),1),l(c,{type:"info",closable:!1,class:"mt-4"},{default:a(()=>[...e[15]||(e[15]=[u(" 注意：此工具仅解析 JWT，不验证签名。请勿将敏感 Token 粘贴到不信任的网站。 ",-1)])]),_:1})]),_:1})],64))],64)):(d(),k(f,{key:1,description:"输入 JWT 后显示解析结果"}))])}}});export{L as default};
