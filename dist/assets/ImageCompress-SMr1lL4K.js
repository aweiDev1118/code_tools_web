import{d as q,p as i,c as h,a as s,b as o,w as n,r as d,t as m,e as V,i as j,n as B,o as c,E as A}from"./index-DoZDeQgx.js";const H={class:"max-w-6xl mx-auto"},K={class:"flex flex-wrap gap-6 items-center"},O={class:"flex items-center gap-2"},T={class:"text-sm w-10"},W={class:"flex items-center gap-2"},G={class:"flex items-center gap-2"},J={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},P={class:"flex justify-between"},Q={key:0,class:"text-sm text-gray-500"},X={key:1,class:"flex items-center justify-center min-h-[200px] bg-gray-50 dark:bg-gray-700 rounded"},Y=["src"],Z={class:"flex justify-between items-center"},$={key:0,class:"flex items-center gap-2"},ee={class:"text-sm text-gray-500"},te={class:"flex items-center justify-center min-h-[200px] bg-gray-50 dark:bg-gray-700 rounded"},se=["src"],ae={key:1,class:"text-gray-400"},ne=q({__name:"ImageCompress",setup(le){const g=i(""),r=i(""),k=i(80),p=i(0),v=i(0),C=i({width:0,height:0}),M=i({width:0,height:0}),_=i(1920),f=i(1080),z=i(!0),I=a=>{if(!a)return;p.value=a.size;const e=new FileReader;return e.onload=l=>{var y;g.value=(y=l.target)==null?void 0:y.result;const t=new Image;t.onload=()=>{C.value={width:t.width,height:t.height},w()},t.src=g.value},e.readAsDataURL(a),!1},w=()=>{if(!g.value)return;const a=new Image;a.onload=()=>{const e=document.createElement("canvas");let{width:l,height:t}=a;if(l>_.value||t>f.value)if(z.value){const x=Math.min(_.value/l,f.value/t);l=Math.round(l*x),t=Math.round(t*x)}else l=Math.min(l,_.value),t=Math.min(t,f.value);e.width=l,e.height=t,M.value={width:l,height:t},e.getContext("2d").drawImage(a,0,0,l,t),r.value=e.toDataURL("image/jpeg",k.value/100);const b=r.value.split(",")[1];v.value=Math.round(b.length*.75)},a.src=g.value},D=()=>{if(!r.value)return;const a=document.createElement("a");a.download="compressed.jpg",a.href=r.value,a.click(),A.success("下载成功")},U=a=>{if(a===0)return"0 B";const e=1024,l=["B","KB","MB"],t=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,t)).toFixed(2))+" "+l[t]},E=()=>!p.value||!v.value?0:Math.round((1-v.value/p.value)*100),R=()=>{g.value="",r.value="",p.value=0,v.value=0};return(a,e)=>{const l=d("el-slider"),t=d("el-input-number"),y=d("el-checkbox"),b=d("el-button"),x=d("el-card"),F=d("Upload"),N=d("el-icon"),S=d("el-upload"),L=d("el-tag");return c(),h("div",H,[e[13]||(e[13]=s("div",{class:"mb-6"},[s("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},"图片压缩"),s("p",{class:"text-gray-500"},"在线压缩图片，减小文件体积")],-1)),o(x,{class:"mb-4"},{default:n(()=>[s("div",K,[s("div",O,[e[4]||(e[4]=s("span",{class:"text-sm"},"质量:",-1)),o(l,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=u=>k.value=u),min:10,max:100,style:{width:"150px"},onChange:w},null,8,["modelValue"]),s("span",T,m(k.value)+"%",1)]),s("div",W,[e[5]||(e[5]=s("span",{class:"text-sm"},"最大宽度:",-1)),o(t,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=u=>_.value=u),min:100,max:4096,size:"small",onChange:w},null,8,["modelValue"])]),s("div",G,[e[6]||(e[6]=s("span",{class:"text-sm"},"最大高度:",-1)),o(t,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=u=>f.value=u),min:100,max:4096,size:"small",onChange:w},null,8,["modelValue"])]),o(y,{modelValue:z.value,"onUpdate:modelValue":e[3]||(e[3]=u=>z.value=u),onChange:w},{default:n(()=>[...e[7]||(e[7]=[V("保持比例",-1)])]),_:1},8,["modelValue"]),o(b,{onClick:R},{default:n(()=>[...e[8]||(e[8]=[V("清空",-1)])]),_:1})])]),_:1}),s("div",J,[o(x,null,{header:n(()=>[s("div",P,[e[9]||(e[9]=s("span",null,"原图",-1)),p.value?(c(),h("span",Q,m(U(p.value))+" | "+m(C.value.width)+" x "+m(C.value.height),1)):B("",!0)])]),default:n(()=>[g.value?(c(),h("div",X,[s("img",{src:g.value,alt:"Original",class:"max-w-full max-h-[300px]"},null,8,Y)])):(c(),j(S,{key:0,drag:"","auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":u=>I(u.raw)},{default:n(()=>[o(N,{size:"48",class:"text-gray-400"},{default:n(()=>[o(F)]),_:1}),e[10]||(e[10]=s("div",{class:"text-gray-500 mt-2"},"拖拽图片或点击选择",-1))]),_:1},8,["on-change"]))]),_:1}),o(x,null,{header:n(()=>[s("div",Z,[e[11]||(e[11]=s("span",null,"压缩后",-1)),v.value?(c(),h("div",$,[s("span",ee,m(U(v.value))+" | "+m(M.value.width)+" x "+m(M.value.height),1),o(L,{type:"success",size:"small"},{default:n(()=>[V("-"+m(E())+"%",1)]),_:1})])):B("",!0)])]),default:n(()=>[s("div",te,[r.value?(c(),h("img",{key:0,src:r.value,alt:"Compressed",class:"max-w-full max-h-[300px]"},null,8,se)):(c(),h("span",ae,"压缩结果"))]),r.value?(c(),j(b,{key:0,type:"primary",class:"w-full mt-4",onClick:D},{default:n(()=>[...e[12]||(e[12]=[V(" 下载压缩图片 ",-1)])]),_:1})):B("",!0)]),_:1})])])}}});export{ne as default};
