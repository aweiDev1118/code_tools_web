import"./index-B5EKCtqV.js";/* empty css               *//* empty css                    *//* empty css                  *//* empty css                    *//* empty css                 *//* empty css                        *//* empty css                  */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{aa as L,ad as K,ae as O,Z as T,a1 as q,E as A,a4 as H,ac as W,a5 as Z}from"./element-plus-CXT1njFj.js";import{v as G,r as i,B as x,D as a,O as o,F as n,L as d,K as C,y as B,ad as J,I as M,z as m}from"./vue-vendor-BNOOKFHJ.js";const P={class:"max-w-6xl mx-auto"},Q={class:"flex flex-wrap gap-6 items-center"},X={class:"flex items-center gap-2"},Y={class:"text-sm w-10"},$={class:"flex items-center gap-2"},ee={class:"flex items-center gap-2"},te={class:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ae={class:"flex justify-between"},se={key:0,class:"text-sm text-gray-500"},le={key:1,class:"flex items-center justify-center min-h-[200px] bg-gray-50 dark:bg-gray-700 rounded"},oe=["src"],ne={class:"flex justify-between items-center"},ie={key:0,class:"flex items-center gap-2"},re={class:"text-sm text-gray-500"},ue={class:"flex items-center justify-center min-h-[200px] bg-gray-50 dark:bg-gray-700 rounded"},de=["src"],me={key:1,class:"text-gray-400"},be=G({__name:"ImageCompress",setup(ce){const c=i(""),u=i(""),y=i(80),p=i(0),g=i(0),V=i({width:0,height:0}),b=i({width:0,height:0}),h=i(1920),_=i(1080),E=i(!0),I=s=>{if(!s)return;p.value=s.size;const e=new FileReader;return e.onload=l=>{var w;c.value=(w=l.target)==null?void 0:w.result;const t=new Image;t.onload=()=>{V.value={width:t.width,height:t.height},f()},t.src=c.value},e.readAsDataURL(s),!1},f=()=>{if(!c.value)return;const s=new Image;s.onload=()=>{const e=document.createElement("canvas");let{width:l,height:t}=s;if(l>h.value||t>_.value)if(E.value){const v=Math.min(h.value/l,_.value/t);l=Math.round(l*v),t=Math.round(t*v)}else l=Math.min(l,h.value),t=Math.min(t,_.value);e.width=l,e.height=t,b.value={width:l,height:t},e.getContext("2d").drawImage(s,0,0,l,t),u.value=e.toDataURL("image/jpeg",y.value/100);const k=u.value.split(",")[1];g.value=Math.round(k.length*.75)},s.src=c.value},U=()=>{if(!u.value)return;const s=document.createElement("a");s.download="compressed.jpg",s.href=u.value,s.click(),Z.success("下载成功")},z=s=>{if(s===0)return"0 B";const e=1024,l=["B","KB","MB"],t=Math.floor(Math.log(s)/Math.log(e));return parseFloat((s/Math.pow(e,t)).toFixed(2))+" "+l[t]},j=()=>!p.value||!g.value?0:Math.round((1-g.value/p.value)*100),D=()=>{c.value="",u.value="",p.value=0,g.value=0};return(s,e)=>{const l=L,t=K,w=O,k=T,v=q,F=J("Upload"),N=A,R=W,S=H;return m(),x("div",P,[e[13]||(e[13]=a("div",{class:"mb-6"},[a("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},"图片压缩"),a("p",{class:"text-gray-500"},"在线压缩图片，减小文件体积")],-1)),o(v,{class:"mb-4"},{default:n(()=>[a("div",Q,[a("div",X,[e[4]||(e[4]=a("span",{class:"text-sm"},"质量:",-1)),o(l,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=r=>y.value=r),min:10,max:100,style:{width:"150px"},onChange:f},null,8,["modelValue"]),a("span",Y,d(y.value)+"%",1)]),a("div",$,[e[5]||(e[5]=a("span",{class:"text-sm"},"最大宽度:",-1)),o(t,{modelValue:h.value,"onUpdate:modelValue":e[1]||(e[1]=r=>h.value=r),min:100,max:4096,size:"small",onChange:f},null,8,["modelValue"])]),a("div",ee,[e[6]||(e[6]=a("span",{class:"text-sm"},"最大高度:",-1)),o(t,{modelValue:_.value,"onUpdate:modelValue":e[2]||(e[2]=r=>_.value=r),min:100,max:4096,size:"small",onChange:f},null,8,["modelValue"])]),o(w,{modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=r=>E.value=r),onChange:f},{default:n(()=>[...e[7]||(e[7]=[C("保持比例",-1)])]),_:1},8,["modelValue"]),o(k,{onClick:D},{default:n(()=>[...e[8]||(e[8]=[C("清空",-1)])]),_:1})])]),_:1}),a("div",te,[o(v,null,{header:n(()=>[a("div",ae,[e[9]||(e[9]=a("span",null,"原图",-1)),p.value?(m(),x("span",se,d(z(p.value))+" | "+d(V.value.width)+" x "+d(V.value.height),1)):M("",!0)])]),default:n(()=>[c.value?(m(),x("div",le,[a("img",{src:c.value,alt:"Original",class:"max-w-full max-h-[300px]"},null,8,oe)])):(m(),B(R,{key:0,drag:"","auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":r=>I(r.raw)},{default:n(()=>[o(N,{size:"48",class:"text-gray-400"},{default:n(()=>[o(F)]),_:1}),e[10]||(e[10]=a("div",{class:"text-gray-500 mt-2"},"拖拽图片或点击选择",-1))]),_:1},8,["on-change"]))]),_:1}),o(v,null,{header:n(()=>[a("div",ne,[e[11]||(e[11]=a("span",null,"压缩后",-1)),g.value?(m(),x("div",ie,[a("span",re,d(z(g.value))+" | "+d(b.value.width)+" x "+d(b.value.height),1),o(S,{type:"success",size:"small"},{default:n(()=>[C("-"+d(j())+"%",1)]),_:1})])):M("",!0)])]),default:n(()=>[a("div",ue,[u.value?(m(),x("img",{key:0,src:u.value,alt:"Compressed",class:"max-w-full max-h-[300px]"},null,8,de)):(m(),x("span",me,"压缩结果"))]),u.value?(m(),B(k,{key:0,type:"primary",class:"w-full mt-4",onClick:U},{default:n(()=>[...e[12]||(e[12]=[C(" 下载压缩图片 ",-1)])]),_:1})):M("",!0)]),_:1})])])}}});export{be as default};
