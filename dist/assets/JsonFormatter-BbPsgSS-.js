import{c as R}from"./clipboard-P4sF3HYx.js";import{d as X,p as x,q as ce,s as ie,l as H,v as ye,c as S,a as c,b as o,w as u,e as p,r as b,n as E,t as ve,i as q,x as P,y as pe,u as me,F as fe,z as s,o as h,E as V,_ as ge}from"./index-DEuvDXVw.js";const xe={class:"max-w-6xl mx-auto"},he={class:"mb-4 flex flex-wrap gap-2"},ke={class:"ml-auto flex items-center gap-2"},be={class:"flex items-center justify-between"},_e={key:0,class:"mt-2 text-sm text-red-500"},Se={class:"flex items-center justify-between flex-wrap gap-2"},Ne={class:"flex items-center gap-2"},je={key:1,class:"json-tree-container"},we={key:0,class:"text-gray-400 text-center py-10"},Ce={key:1,class:"json-tree"},Oe=X({__name:"JsonFormatter",setup(Je){const i=x(""),O=x(2),y=x(""),J=x("tree"),m=x(new Set),W=x(3),K=x(50),N=x(!1),A=x(null),G=e=>{e.preventDefault(),N.value=!0,document.body.style.cursor="col-resize",document.body.style.userSelect="none"},F=e=>{if(!N.value||!A.value)return;const l=A.value.getBoundingClientRect(),r=(e.clientX-l.left)/l.width*100;K.value=Math.min(80,Math.max(20,r))},U=()=>{N.value&&(N.value=!1,document.body.style.cursor="",document.body.style.userSelect="")};ce(()=>{document.addEventListener("mousemove",F),document.addEventListener("mouseup",U)}),ie(()=>{document.removeEventListener("mousemove",F),document.removeEventListener("mouseup",U)});const v=H(()=>{if(!i.value.trim())return y.value="",null;try{const e=JSON.parse(i.value);return y.value="",e}catch(e){return y.value=e.message,null}}),L=H(()=>v.value===null?"":JSON.stringify(v.value,null,O.value)),Q=e=>{m.value.has(e)?m.value.delete(e):m.value.add(e),m.value=new Set(m.value)},B=(e,t="root",l=0)=>{const d=[];return e===null||typeof e!="object"||(d.push(t),Array.isArray(e)?e.forEach((r,a)=>{const n=`${t}[${a}]`;d.push(...B(r,n,l+1))}):Object.keys(e).forEach(r=>{const a=`${t}.${r}`;d.push(...B(e[r],a,l+1))})),d},M=(e,t,l="root",d=0)=>{const r=[];return e===null||typeof e!="object"||d>=t||(r.push(l),Array.isArray(e)?e.forEach((a,n)=>{const f=`${l}[${n}]`;r.push(...M(a,t,f,d+1))}):Object.keys(e).forEach(a=>{const n=`${l}.${a}`;r.push(...M(e[a],t,n,d+1))})),r},Y=()=>{if(!v.value)return;const e=B(v.value);m.value=new Set(e)},Z=()=>{m.value=new Set},ee=e=>{if(!v.value)return;const t=M(v.value,e);m.value=new Set(t)};ye(v,e=>{e&&ee(W.value)},{immediate:!0});const te=()=>{if(i.value.trim())try{const e=JSON.parse(i.value);i.value=JSON.stringify(e,null,O.value),y.value="",V.success("格式化成功")}catch(e){y.value=e.message,V.error("JSON 格式错误")}},ae=()=>{if(i.value.trim())try{const e=JSON.parse(i.value);i.value=JSON.stringify(e),y.value="",V.success("压缩成功")}catch(e){y.value=e.message,V.error("JSON 格式错误")}},se=()=>{L.value&&R(L.value)},le=e=>{const t=typeof e=="string"?e:JSON.stringify(e,null,2);R(t)},ne=()=>{i.value="",y.value="",m.value=new Set},oe=()=>{i.value=JSON.stringify({name:"开发工具箱",version:"1.0.0",active:!0,count:42,config:null,features:["JSON格式化","Base64编码","时间戳转换"],settings:{theme:"light",language:"zh-CN",advanced:{debug:!1,timeout:3e3}},users:[{id:1,name:"Alice"},{id:2,name:"Bob"}]},null,2)},T=X({name:"JsonNode",props:{data:{type:null,required:!0},path:{type:String,required:!0},expandedKeys:{type:Object,required:!0},level:{type:Number,default:0},keyName:{type:String,default:""},isLast:{type:Boolean,default:!0},isArrayItem:{type:Boolean,default:!1},arrayIndex:{type:Number,default:-1}},emits:["toggle","copy"],setup(e,{emit:t}){const l=a=>a===null?"null":Array.isArray(a)?"array":typeof a,d=a=>{const n=l(a);return n==="object"?Object.keys(a).length>0:n==="array"?a.length>0:!1},r=()=>e.expandedKeys.has(e.path);return()=>{const a=l(e.data),n=d(e.data),f=r(),j=e.level*24,D=n?s("span",{class:["toggle-btn",f?"expanded":"collapsed"],onClick:k=>{k.stopPropagation(),t("toggle",e.path)}},[s("svg",{viewBox:"0 0 24 24",width:"10",height:"10",fill:"currentColor"},[f?s("path",{d:"M19 13H5v-2h14v2z"}):s("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})])]):s("span",{class:"toggle-placeholder"}),_=e.keyName?[s("span",{class:"json-key"},`"${e.keyName}"`),s("span",{class:"json-colon"},": ")]:e.isArrayItem?[]:[];let w=[];if(n)f?w=[s("span",{class:"json-bracket"},a==="array"?"[":"{")]:a==="array"?w=[s("span",{class:"json-bracket"},"["),s("span",{class:"json-collapsed"},`${e.data.length} items`),s("span",{class:"json-bracket"},"]")]:w=[s("span",{class:"json-collapsed-obj"},[s("span",{class:"json-bracket"},"{"),s("span",{class:"json-collapsed"},`${Object.keys(e.data).length} keys`),s("span",{class:"json-bracket"},"}")])];else{let k;a==="string"?k=`"${e.data}"`:a==="null"?k="null":k=String(e.data),w=[s("span",{class:`json-value json-${a}`},k)]}const re=!e.isLast&&(!n||!f)?s("span",{class:"json-comma"},","):null,ue=[D,..._,...w,re],de=s("div",{class:["json-line",{expandable:n}],style:{paddingLeft:`${j}px`},onClick:()=>n&&t("toggle",e.path)},ue);let $=[];if(n&&f){if(a==="array")$=e.data.map((z,g)=>s(T,{key:g,data:z,path:`${e.path}[${g}]`,expandedKeys:e.expandedKeys,level:e.level+1,isArrayItem:!0,arrayIndex:g,isLast:g===e.data.length-1,onToggle:C=>t("toggle",C),onCopy:C=>t("copy",C)}));else{const z=Object.keys(e.data);$=z.map((g,C)=>s(T,{key:g,data:e.data[g],path:`${e.path}.${g}`,expandedKeys:e.expandedKeys,level:e.level+1,keyName:g,isLast:C===z.length-1,onToggle:I=>t("toggle",I),onCopy:I=>t("copy",I)}))}const k=s("div",{class:"json-line",style:{paddingLeft:`${j}px`}},[s("span",{class:"toggle-placeholder"}),s("span",{class:"json-bracket"},a==="array"?"]":"}"),e.isLast?null:s("span",{class:"json-comma"},",")]);$.push(k)}return s("div",{class:"json-node"},[de,...$])}}});return(e,t)=>{const l=b("el-button"),d=b("el-option"),r=b("el-select"),a=b("el-tag"),n=b("el-input"),f=b("el-card"),j=b("el-radio-button"),D=b("el-radio-group");return h(),S("div",xe,[t[18]||(t[18]=c("div",{class:"mb-6"},[c("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},"JSON 格式化"),c("p",{class:"text-gray-500"},"格式化、压缩、校验 JSON 数据，支持树形可视化")],-1)),c("div",he,[o(l,{type:"primary",onClick:te},{default:u(()=>[...t[3]||(t[3]=[p("格式化",-1)])]),_:1}),o(l,{onClick:ae},{default:u(()=>[...t[4]||(t[4]=[p("压缩",-1)])]),_:1}),o(l,{onClick:se},{default:u(()=>[...t[5]||(t[5]=[p("复制结果",-1)])]),_:1}),o(l,{onClick:ne},{default:u(()=>[...t[6]||(t[6]=[p("清空",-1)])]),_:1}),o(l,{onClick:oe,text:""},{default:u(()=>[...t[7]||(t[7]=[p("加载示例",-1)])]),_:1}),c("div",ke,[t[8]||(t[8]=c("span",{class:"text-sm text-gray-500"},"缩进:",-1)),o(r,{modelValue:O.value,"onUpdate:modelValue":t[0]||(t[0]=_=>O.value=_),style:{width:"80px"}},{default:u(()=>[o(d,{value:2,label:"2 空格"}),o(d,{value:4,label:"4 空格"}),o(d,{value:1,label:"Tab"})]),_:1},8,["modelValue"])])]),c("div",{ref_key:"containerRef",ref:A,class:"resizable-container"},[o(f,{class:"panel-card",style:P({width:K.value+"%"})},{header:u(()=>[c("div",be,[t[11]||(t[11]=c("span",null,"输入",-1)),y.value?(h(),q(a,{key:0,type:"danger",size:"small"},{default:u(()=>[...t[9]||(t[9]=[p("格式错误",-1)])]),_:1})):i.value.trim()?(h(),q(a,{key:1,type:"success",size:"small"},{default:u(()=>[...t[10]||(t[10]=[p("有效 JSON",-1)])]),_:1})):E("",!0)])]),default:u(()=>[o(n,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=_=>i.value=_),type:"textarea",rows:20,placeholder:"请输入 JSON 数据...",class:"font-mono"},null,8,["modelValue"]),y.value?(h(),S("div",_e,ve(y.value),1)):E("",!0)]),_:1},8,["style"]),c("div",{class:pe(["resizer",{dragging:N.value}]),onMousedown:G},[...t[12]||(t[12]=[c("div",{class:"resizer-line"},null,-1)])],34),o(f,{class:"panel-card json-output-card",style:P({width:100-K.value+"%"})},{header:u(()=>[c("div",Se,[t[17]||(t[17]=c("span",null,"输出",-1)),c("div",Ne,[o(D,{modelValue:J.value,"onUpdate:modelValue":t[2]||(t[2]=_=>J.value=_),size:"small"},{default:u(()=>[o(j,{value:"tree"},{default:u(()=>[...t[13]||(t[13]=[p("树形",-1)])]),_:1}),o(j,{value:"text"},{default:u(()=>[...t[14]||(t[14]=[p("文本",-1)])]),_:1})]),_:1},8,["modelValue"]),J.value==="tree"&&v.value?(h(),S(fe,{key:0},[o(l,{size:"small",onClick:Y},{default:u(()=>[...t[15]||(t[15]=[p("展开全部",-1)])]),_:1}),o(l,{size:"small",onClick:Z},{default:u(()=>[...t[16]||(t[16]=[p("折叠全部",-1)])]),_:1})],64)):E("",!0)])])]),default:u(()=>[J.value==="text"?(h(),q(n,{key:0,"model-value":L.value,type:"textarea",rows:20,readonly:"",placeholder:"格式化结果将显示在这里...",class:"font-mono"},null,8,["model-value"])):(h(),S("div",je,[!v.value&&!y.value?(h(),S("div",we," 格式化结果将显示在这里... ")):v.value?(h(),S("div",Ce,[o(me(T),{data:v.value,path:"root","expanded-keys":m.value,level:0,onToggle:Q,onCopy:le},null,8,["data","expanded-keys"])])):E("",!0)]))]),_:1},8,["style"])],512)])}}}),Ee=ge(Oe,[["__scopeId","data-v-b510f548"]]);export{Ee as default};
